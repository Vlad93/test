"use strict";function asyncGeneratorStep(e,t,r,n,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){asyncGeneratorStep(o,n,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,n,a,i,s,"throw",e)}i(void 0)}))}}document.addEventListener("DOMContentLoaded",(function(){var e=function(e,t,r){var n=["Janiary","Febriary","March","April","May","June","July","August","September","October","November","December"],a=new Date;e=document.getElementById(e),t=document.getElementById(t),r=document.getElementById(r);for(var o=0;o<12;o++)t.options[o]=new Option(n[o],n[o]);t.options[11].selected=!0;for(var i=1900,s=0;s<a.getFullYear()-1899;s++)r.options[s]=new Option(i,i),i+=1;function l(e){var r=n.findIndex((function(e){return e===t.value}));return new Date(e,r+1,0).getDate()}r.options[0]=new Option(1900,1900),r.options[95].selected=!0;for(var u=l(r.value),d=0;d<u;d++)e.options[d]=d<9?new Option("0"+(d+1),"0"+(d+1)):new Option(d+1,d+1);return e.options[20].selected=!0,{monthtext:n,dayfield:e,monthfield:t,yearfield:r,getLastDayOfMonth:l}}("date","month","year"),t=document.getElementById("nationality"),r=(new Choices(t,{silent:!0,searchEnabled:!1,itemSelectText:"",duplicateItemsAllowed:!1}),new Choices(e.dayfield,{silent:!0,searchEnabled:!1,itemSelectText:"",duplicateItemsAllowed:!1}));new Choices(e.monthfield,{silent:!0,searchEnabled:!1,itemSelectText:"",duplicateItemsAllowed:!1}),new Choices(e.yearfield,{silent:!0,searchEnabled:!1,itemSelectText:"",duplicateItemsAllowed:!1});e.monthfield.addEventListener("change",(function(){r.destroy();var t=e.getLastDayOfMonth(e.yearfield.value);e.dayfield.innerHTML="";for(var n=0;n<t;n++)e.dayfield.options[n]=n<9?new Option("0"+(n+1),"0"+(n+1)):new Option(n+1,n+1);r=new Choices(e.dayfield,{silent:!0,searchEnabled:!1,itemSelectText:"",duplicateItemsAllowed:!1})})),e.yearfield.addEventListener("change",(function(){r.destroy();var t=e.getLastDayOfMonth(e.yearfield.value);e.dayfield.innerHTML="";for(var n=0;n<t;n++)e.dayfield.options[n]=n<9?new Option("0"+(n+1),"0"+(n+1)):new Option(n+1,n+1);r=new Choices(e.dayfield,{silent:!0,searchEnabled:!1,itemSelectText:"",duplicateItemsAllowed:!1})}));var n=document.querySelector(".preloader"),a=document.querySelector(".signup-form"),o=document.querySelector(".signup-form__btn"),i=document.querySelector(".modal-window-thanks"),s=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",body:r});case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Ошибка по адресу ".concat(t,", статус ошибки ").concat(n.status));case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),l=gsap.timeline();document.querySelectorAll(".signup-form__input-wrap").forEach((function(e){l.from(e,{opacity:0,y:40,duration:.6,ease:"power3.out"},"-=.3")})),l.from(".signup-form__complete-wrap",{opacity:0,y:40,duration:.6,ease:"power3.out"},">"),l.eventCallback("onComplete",(function(){document.querySelectorAll(".signup-form__input-wrap").forEach((function(e){e.style=""})),document.querySelector(".signup-form__complete-wrap").style=""})),new Vivus("user-icon",{type:"delayed",duration:200,animTimingFunction:Vivus.EASE}).play((function(){document.getElementById("user-icon").classList.add("filled")})),new JustValidate(a,{errorFieldCssClass:"is-invalid",successFieldCssClass:"is-success",validateBeforeSubmitting:!0,focusInvalidField:!1,errorLabelCssClass:"input-error",errorLabelStyle:{color:"#ff2828"}}).addField("#name",[{rule:"required",errorMessage:"The field is required"},{rule:"minLength",value:2,errorMessage:"The field must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"The field must contain a maximum of 30 characters"},{rule:"customRegexp",value:"[A-Za-zА-Яа-яёЁ]",errorMessage:"The field can only contain letters and davis"}]).addField("#lastname",[{rule:"required",errorMessage:"The field is required"},{rule:"minLength",value:2,errorMessage:"The field must contain a minimum of 2 characters"},{rule:"maxLength",value:30,errorMessage:"The field must contain a maximum of 30 characters"},{rule:"customRegexp",value:"[A-Za-zА-Яа-яёЁ]",errorMessage:"The field can only contain letters and davis"}]).addField("#email",[{rule:"required",errorMessage:"The field is required"},{rule:"email",errorMessage:"Email has invalid format"}]).addRequiredGroup(".radios-wrap","Select at lease one option!").addField("#password",[{rule:"required",errorMessage:"The field is required"},{rule:"customRegexp",value:"(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{8,}",errorMessage:"Password should contain minimum eight characters, at least one uppercase letter, one lowercase letter and one number"}]).addField("#confirm-password",[{rule:"required",errorMessage:"The field is required"},{validator:function(e,t){return!t[5]||e===t[5].elem.value},errorMessage:"Passwords should be the same"}]).onFail((function(e){o.classList.add("btn-error-submit"),o.addEventListener("animationend",(function(){o.classList.remove("btn-error-submit"),document.querySelector(".input-error").scrollIntoView({block:"center",behavior:"smooth"})}))})).onSuccess((function(t){t.preventDefault();var r=document.getElementById("bdate"),o=e.monthtext.findIndex((function(t){return e.monthfield.value===t}))+1;o<=9&&(o="0"+o),r.value="".concat(e.yearfield.value,"-").concat(o,"-").concat(e.dayfield.value);var l=new FormData(a);s("https://jsonplaceholder.typicode.com/posts",l).then((function(){a.reset(),n.classList.add("active"),document.querySelector(".signup-form__login").style.zIndex="9",setTimeout((function(){n.classList.remove("active"),i.classList.add("show")}),1500),setTimeout((function(){i.classList.remove("show"),document.querySelector(".signup-form__login").style.zIndex="4"}),4e3)})).catch((function(e){alert(e)}))}))}));